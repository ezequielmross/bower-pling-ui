!function(e){"use strict";e.pling={}}(window),function(){"use strict";function e(e){e.decorator("$log",function(e,t){return t(e)})}function t(e,t){var i=null;e.onRun&&e.onRun.cacheViews&&(i=t.get("cacheService"),i.cacheViews())}angular.module("plingUi",["plingUi.templates","ngMaterial","datetime"]),angular.module("plingUi").config(["$provide",e]),angular.module("plingUi").run(["boot.options","$injector",t])}(),function(){"use strict";angular.module("plingUi").service("cepService",["$http","boot.options",function(e,t){this.getCep=function(i){var o=t.cep_url+i;return e.get(o)}}])}(),function(){"use strict";angular.module("plingUi").service("coreApiService",["boot.options",function(e){var t=e.core_url+e.def_api_version+"/"+e.def_api_app+"/",i=e.accounts_url,o=e.login_url,r=e.def_api_app;this.getAppCoreUrl=function(){return t},this.getAccountsCoreUrl=function(){return e.core_url+e.def_api_version+"/accounts/"},this.getDriveCoreUrl=function(){return e.core_url+e.def_api_version+"/drive/"},this.getAccountsUrl=function(){return i},this.getLoginUrl=function(){return o},this.getApplicationName=function(){return r.charAt(0).toUpperCase()+r.slice(1)}}])}(),function(e,t){"use strict";function i(){this.isBootstrapped=!1}i.prototype.Angular=function(i,o,r,n){var s=this;e.loader.load(r,function(e,r){e?(t.warn("Config file not loaded!"),t.debug(e)):angular.module(o).value("boot.options",r),angular.bootstrap(i,[o]),s.isBootstrapped=!0,n&&n(e)})},e.boot=new i}(window.pling,window.console),function(e,t,i){"use strict";function o(){var o,r="plg-app",n="src",s="["+r+"]";o=e.querySelector(s),o?(i.name=o.getAttribute(r),i.source=o.getAttribute(n)||"pling.conf.json",t.info("AngularJS 1.x spa check:",!0),i.boot.Angular(o,i.name,i.source,function(e){e?t.error("Could not boot app ",i.name):t.info("Bootstrapped:",i.boot.isBootstrapped)})):t.info("AngularJS 1.x spa check:",!1)}e.addEventListener("DOMContentLoaded",o)}(document,window.console,window.pling),function(e){"use strict";function t(){this.settings=null}t.prototype.load=function(e,t){var i,o=this,r=new XMLHttpRequest;r.onreadystatechange=function(){4===r.readyState&&(200===r.status?(i=JSON.parse(r.responseText),o.settings=i,t(null,i)):t("Error loading file - status "+r.status,{}))},r.onerror=function(e){t(e)},r.open("GET",e,!0),r.setRequestHeader("Content-Type","application/json;charset=UTF-8"),r.send()},e.loader=new t}(window.pling),function(){"use strict";function e(e,t,i){this.cacheViews=function(o,r){var n,s,a=o||e,c=r||t;for(s in c.routes)c.routes.hasOwnProperty(s)&&(n=c.routes[s].templateUrl,n&&i.get(n,{cache:a}))}}e.$inject=["$templateCache","$route","$http"],angular.module("plingUi").service("cacheService",e)}(),function(){"use strict";angular.module("plingUi").service("$localstorage",["$window",function(e){return{remove:function(){e.localStorage.clear()},set:function(t,i){e.localStorage[t]=i},get:function(t){return e.localStorage[t]},setObject:function(t,i){e.localStorage[t]=JSON.stringify(i)},getObject:function(t){return JSON.parse(e.localStorage[t]||"{}")}}}])}(),function(){"use strict";angular.module("plingUi").service("$sessionstorage",["$window",function(e){return{remove:function(){e.sessionStorage.clear()},set:function(t,i){e.sessionStorage[t]=i},get:function(t){return e.sessionStorage[t]},setObject:function(t,i){e.sessionStorage[t]=JSON.stringify(i)},getObject:function(t){return JSON.parse(e.sessionStorage[t]||"{}")}}}])}(),function(){"use strict";function e(e){return function(t,i){var o=null,r=null,n={error:t,details:i};r=e.get("$log"),r.error(t),i&&r.debug(i),o=e.get("$rootScope"),o.$broadcast("PLINGUI_INTERNAL_ERROR",n)}}e.$inject=["$injector"],angular.module("plingUi").factory("$exceptionHandler",e)}(),function(){"use strict";function e(){return function(e){return{dispatch:function(t,i){var o,r=e[t]||e.log,n=(new Date).toString(),s="["+n+"]["+t+"]::",a=[];if(t){a.push(s);for(o in i)i.hasOwnProperty(o)&&a.push(i[o]);r.apply(null,a)}},log:function(){this.dispatch("log",arguments)},info:function(){this.dispatch("info",arguments)},error:function(){this.dispatch("error",arguments)},warn:function(){this.dispatch("warn",arguments)}}}}angular.module("plingUi").factory("shadowLogger",e)}(),function(){"use strict";angular.module("plingUi").directive("plgSample",function(){return{restrict:"E",controller:"MyController",templateUrl:"myComponentSample.html",link:function(e,t,i){t.css("background-color","white"),e.tagline="it Works! Attrs: "+i}}})}(),function(){"use strict";function e(e,t,i,o,r,n){return{restrict:"E",scope:{params:"=",serviceModule:"=",dynamicForm:"=",filterDefault:"=",orderBy:"=",limit:"=",page:"=",total:"=",viewItems:"=",gapiDataTableFilters:"=",paginate:"&"},replace:!0,link:function(s,a){var c,l;s.params&&(c={buildTemplate:function(e,t){var i;e.selected=[],e.chkList=!1,e.editView=this.editView,e.toggleAll=this.toggleAll,e.allActions=this.allActions,e.options={autoSelect:!1,boundaryLinks:!1,largeEditDialog:!1,pageSelector:!1,rowSelection:!0},e.query={order:e.orderBy},i='<md-content layout="column" flex>   <md-table-container>       <table md-table md-row-select="options.rowSelection" ng-model="selected" md-progress="promise" ng-click="toggleAll()">       <thead md-head md-order="query.order" md-on-reorder="logOrder">           <tr md-row>               <th md-column md-order-by="{{ header.ref }}" ng-repeat="header in dynamicForm.showInList"><span>{{ header.label }}</span></th>           </tr>       </thead>       <tbody md-body>           <tr md-row md-select="obj" md-on-select="toggleAll" md-on-deselect="toggleAll" ng-click="editView(serviceModule.module, obj._id)" md-on-select="logItem" md-auto-select="options.autoSelect" ng-repeat="obj in params | filter: filter.search | orderBy: query.order" style="cursor: pointer !important">               <td md-cell ng-repeat="item in dynamicForm.showInList">{{obj[item.ref]}}</md-cell>               <td md-cell ng-show="gapiDataTableFilters">                   <plg-data-table-filters                       params="obj"                       service-module="serviceModule"                       dynamic-form="dynamicForm"                       filter-default="filterDefault">                   </plg-data-table-filters>               </td>           </tr>       </tbody>       </table>   </md-table-container>   <md-table-pagination md-limit="limit" md-page="page" md-total="{{total}}" md-on-paginate="paginate()"></md-table-pagination>   <div layout="row" layout-align="start start" class="actionDataTable">       <md-menu-item ng-show="chkList" ng-repeat="item in viewItems" layout-align="center center">           <md-button class="md-icon-button allActionsIcon" aria-label="Ações" ng-click="allActions(item.method, item.action, item.msg)">               <md-tooltip>{{item.name}}</md-tooltip>               <md-icon md-svg-src="{{item.moduleIcon}}" class="icons"></md-icon>           </md-button>       </md-menu-item>   </div></md-content>',t(null,i)},editView:function(e,t){i.path(e+"/"+t)},toggleAll:function(){s.chkList=!1,s.selected.length>0&&(s.chkList=!0)},allActions:function(e,t,i){var a={};a[e]=t,s.selected.forEach(function(c,l){o.patch(n.getAppCoreUrl()+s.serviceModule.collection+"/"+c._id,a).success(function(o){o?(l+1===s.selected.length&&r.$emit("saveRecordSuccess","Registros "+i+" com sucesso."),s.selected.length=0,s.chkList=!1,r.$emit("research",[c],e,t)):r.$emit("recordError","Ocorreu um erro ao "+i)})})}},c.buildTemplate(s,function(i,o){return i?void e.warn(i):(l=t(o)(s),c.postCompile&&c.postCompile(l),void a.replaceWith(l))}))}}}e.$inject=["$log","$compile","$location","$http","$rootScope","coreApiService"],angular.module("plingUi").directive("plgDataTable",e)}(),function(){"use strict";function e(e,t,i,o,r,n){return{restrict:"E",scope:{params:"=",serviceModule:"=",dynamicForm:"=",filterDefault:"="},replace:!0,link:function(s,a){var c,l;s.params&&(c={buildTemplate:function(e,t){var i;e.actionsList=this.actionsList,e.collection=e.serviceModule.collection,e.module=e.serviceModule.module,e.serviceModule.subModuleEdit&&(e.module=e.serviceModule.module+"/"+e.serviceModule.subModuleEdit),e.resultViewItems=n.action(e.filterDefault.action,e.serviceModule.viewItems),i='<md-menu md-offset="0 -7" md-position-mode="target-right target">    <md-button aria-label="" class="md-icon-button" ng-click="$mdOpenMenu($event)" >        <md-tooltip>Ações</md-tooltip>        <md-icon md-svg-src="assets/images/icone_mais.svg"></md-icon>    </md-button>    <md-menu-content layout="column" layout-wrap width="4" >        <md-menu-item flex ng-show="module">           <p><font color="#959595">Alterar Status</font></p>        </md-menu-item>        <md-menu-item flex ng-repeat="item in resultViewItems">            <md-button ng-click="actionsList(params, \'Registro\', item, collection)" style="margin-left: 15px !important">                 <md-icon md-svg-src="{{item.moduleIcon}}"></md-icon>                 {{item.name}}            </md-button>        </md-menu-item>    </md-menu-content></md-menu>',t(null,i)},actionsList:function(t,i,n,s){var a,c={};a=t._id,c[n.method]=n.action,o.patch(r.getAppCoreUrl()+s+"/"+a,c).success(function(o){o?(e.$emit("saveRecordSuccess",i+" "+n.msg+" com sucesso."),e.$emit("research",[t],n.method,n.action)):e.$emit("recordError","Ocorreu um erro ao "+n.msg+" "+s)})}},c.buildTemplate(s,function(e,o){return e?void t.warn(e):(l=i(o)(s),c.postCompile&&c.postCompile(l),void a.replaceWith(l))}))}}}e.$inject=["$rootScope","$log","$compile","$http","coreApiService","formatResultList"],angular.module("plingUi").directive("plgDataTableFilters",e)}(),function(){"use strict";function e(e,t,i){return{restrict:"E",scope:{dynamicForm:"="},replace:!0,link:function(o,r){var n,s;n={buildTemplate:function(e,t){var i;e.serializeQueryString=this.serializeQueryString,e.searchPeople=this.searchPeople,e.searchColorActive=this.searchColorActive,e.searchColorInactivate=this.searchColorInactivate,e.colorIconsTrash=this.colorIconsTrash,e.search=[],e.searchIconsTrash="checkOffColorIconFilter",e.searchIconsActive="checkOffColorIconFilter",e.searchIconsInactivate="checkOffColorIconFilter",i='<div flex="25">    <md-input-container>        <label>Pesquisar</label>        <input ng-model="search.search">    </md-input-container></div><div style="margin-left: 20px !important" flex="25">    <md-input-container>        <md-select multiple ng-model="search.fieldtable" placeholder="Selecione">            <md-option ng-repeat="table in dynamicForm.allField" value="{{table.ref}}">{{table.label}}</md-option>        </md-select>    </md-input-container></div><div style="margin-left: 20px !important">    <md-input-container>        <md-button ng-class="searchIconsActive" class="md-icon-button" ng-click="searchColorActive()">            <md-tooltip md-direction="bottom">Ativos</md-tooltip>            <i class="material-icons">done_all</i>        </md-button>        <md-button ng-class="searchIconsInactivate" class="md-icon-button" ng-click="searchColorInactivate()">            <md-tooltip md-direction="bottom">Inativos</md-tooltip>            <i class="material-icons">highlight_off</i>        </md-button>        <md-button ng-class="searchIconsTrash" class="md-icon-button" ng-click="colorIconsTrash()">            <md-tooltip md-direction="bottom">Excluídos</md-tooltip>            <i class="material-icons">delete</i>        </md-button>    </md-input-container></div><md-button ng-click="searchPeople(search)" ng-show="search.search || search.fieldtable.length > 0 || search.active || search.inactive || search.trash" class="md-raised" style="font-size: 11px !important;">Pesquisar</md-button>',t(null,i)},serializeQueryString:function(e){var t,i=[];for(t in e)e.hasOwnProperty(t)&&encodeURIComponent(e[t])&&i.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return i.length>0?"&"+i.join("&"):i.join("&")},searchPeople:function(e){i.$emit("searchPeople",o.serializeQueryString(e))},searchColorActive:function(){"checkOffColorIconFilter"===o.searchIconsActive?(o.searchIconsActive="checkOnColorIconFilter",o.search.active=!0):(o.searchIconsActive="checkOffColorIconFilter",delete o.search.active)},searchColorInactivate:function(){"checkOffColorIconFilter"===o.searchIconsInactivate?(o.searchIconsInactivate="checkOnColorIconFilter",o.search.inactive=!0):(o.searchIconsInactivate="checkOffColorIconFilter",delete o.search.inactive)},colorIconsTrash:function(){"checkOffColorIconFilter"===o.searchIconsTrash?(o.searchIconsTrash="checkOnColorIconFilter",o.search.trash=!0):(o.searchIconsTrash="checkOffColorIconFilter",delete o.search.trash)}},n.buildTemplate(o,function(i,a){return i?void e.warn(i):(s=t(a)(o),n.postCompile&&n.postCompile(s),void r.replaceWith(s))})}}}e.$inject=["$log","$compile","$rootScope"],angular.module("plingUi").directive("plgDataTableSearch",e)}(),function(){"use strict";var e=angular.module("plingUi",[]);e.factory("cropAreaCircle",["cropArea",function(e){var t=function(){e.apply(this,arguments),this._boxResizeBaseSize=20,this._boxResizeNormalRatio=.9,this._boxResizeHoverRatio=1.2,this._iconMoveNormalRatio=.9,this._iconMoveHoverRatio=1.2,this._boxResizeNormalSize=this._boxResizeBaseSize*this._boxResizeNormalRatio,this._boxResizeHoverSize=this._boxResizeBaseSize*this._boxResizeHoverRatio,this._posDragStartX=0,this._posDragStartY=0,this._posResizeStartX=0,this._posResizeStartY=0,this._posResizeStartSize=0,this._boxResizeIsHover=!1,this._areaIsHover=!1,this._boxResizeIsDragging=!1,this._areaIsDragging=!1};return t.prototype=new e,t.prototype._calcCirclePerimeterCoords=function(e){var t=this._size/2,i=e*(Math.PI/180),o=this._x+t*Math.cos(i),r=this._y+t*Math.sin(i);return[o,r]},t.prototype._calcResizeIconCenterCoords=function(){return this._calcCirclePerimeterCoords(-45)},t.prototype._isCoordWithinArea=function(e){return Math.sqrt((e[0]-this._x)*(e[0]-this._x)+(e[1]-this._y)*(e[1]-this._y))<this._size/2},t.prototype._isCoordWithinBoxResize=function(e){var t=this._calcResizeIconCenterCoords(),i=this._boxResizeHoverSize/2;return e[0]>t[0]-i&&e[0]<t[0]+i&&e[1]>t[1]-i&&e[1]<t[1]+i},t.prototype._drawArea=function(e,t,i){e.arc(t[0],t[1],i/2,0,2*Math.PI)},t.prototype.draw=function(){e.prototype.draw.apply(this,arguments),this._cropCanvas.drawIconMove([this._x,this._y],this._areaIsHover?this._iconMoveHoverRatio:this._iconMoveNormalRatio),this._cropCanvas.drawIconResizeBoxNESW(this._calcResizeIconCenterCoords(),this._boxResizeBaseSize,this._boxResizeIsHover?this._boxResizeHoverRatio:this._boxResizeNormalRatio)},t.prototype.processMouseMove=function(e,t){var i="default",o=!1;if(this._boxResizeIsHover=!1,this._areaIsHover=!1,this._areaIsDragging)this._x=e-this._posDragStartX,this._y=t-this._posDragStartY,this._areaIsHover=!0,i="move",o=!0,this._events.trigger("area-move");else if(this._boxResizeIsDragging){i="nesw-resize";var r,n,s;n=e-this._posResizeStartX,s=this._posResizeStartY-t,r=n>s?this._posResizeStartSize+2*s:this._posResizeStartSize+2*n,this._size=Math.max(this._minSize,r),this._boxResizeIsHover=!0,o=!0,this._events.trigger("area-resize")}else this._isCoordWithinBoxResize([e,t])?(i="nesw-resize",this._areaIsHover=!1,this._boxResizeIsHover=!0,o=!0):this._isCoordWithinArea([e,t])&&(i="move",this._areaIsHover=!0,o=!0);return this._dontDragOutside(),angular.element(this._ctx.canvas).css({cursor:i}),o},t.prototype.processMouseDown=function(e,t){this._isCoordWithinBoxResize([e,t])?(this._areaIsDragging=!1,this._areaIsHover=!1,this._boxResizeIsDragging=!0,this._boxResizeIsHover=!0,this._posResizeStartX=e,this._posResizeStartY=t,this._posResizeStartSize=this._size,this._events.trigger("area-resize-start")):this._isCoordWithinArea([e,t])&&(this._areaIsDragging=!0,this._areaIsHover=!0,this._boxResizeIsDragging=!1,this._boxResizeIsHover=!1,this._posDragStartX=e-this._x,this._posDragStartY=t-this._y,this._events.trigger("area-move-start"))},t.prototype.processMouseUp=function(){this._areaIsDragging&&(this._areaIsDragging=!1,this._events.trigger("area-move-end")),this._boxResizeIsDragging&&(this._boxResizeIsDragging=!1,this._events.trigger("area-resize-end")),this._areaIsHover=!1,this._boxResizeIsHover=!1,this._posDragStartX=0,this._posDragStartY=0},t}]),e.factory("cropAreaSquare",["cropArea",function(e){var t=function(){e.apply(this,arguments),this._resizeCtrlBaseRadius=10,this._resizeCtrlNormalRatio=.75,this._resizeCtrlHoverRatio=1,this._iconMoveNormalRatio=.9,this._iconMoveHoverRatio=1.2,this._resizeCtrlNormalRadius=this._resizeCtrlBaseRadius*this._resizeCtrlNormalRatio,this._resizeCtrlHoverRadius=this._resizeCtrlBaseRadius*this._resizeCtrlHoverRatio,this._posDragStartX=0,this._posDragStartY=0,this._posResizeStartX=0,this._posResizeStartY=0,this._posResizeStartSize=0,this._resizeCtrlIsHover=-1,this._areaIsHover=!1,this._resizeCtrlIsDragging=-1,this._areaIsDragging=!1};return t.prototype=new e,t.prototype._calcSquareCorners=function(){var e=this._size/2;return[[this._x-e,this._y-e],[this._x+e,this._y-e],[this._x-e,this._y+e],[this._x+e,this._y+e]]},t.prototype._calcSquareDimensions=function(){var e=this._size/2;return{left:this._x-e,top:this._y-e,right:this._x+e,bottom:this._y+e}},t.prototype._isCoordWithinArea=function(e){var t=this._calcSquareDimensions();return e[0]>=t.left&&e[0]<=t.right&&e[1]>=t.top&&e[1]<=t.bottom},t.prototype._isCoordWithinResizeCtrl=function(e){for(var t=this._calcSquareCorners(),i=-1,o=0,r=t.length;r>o;o++){var n=t[o];if(e[0]>n[0]-this._resizeCtrlHoverRadius&&e[0]<n[0]+this._resizeCtrlHoverRadius&&e[1]>n[1]-this._resizeCtrlHoverRadius&&e[1]<n[1]+this._resizeCtrlHoverRadius){i=o;break}}return i},t.prototype._drawArea=function(e,t,i){var o=i/2;e.rect(t[0]-o,t[1]-o,i,i)},t.prototype.draw=function(){e.prototype.draw.apply(this,arguments),this._cropCanvas.drawIconMove([this._x,this._y],this._areaIsHover?this._iconMoveHoverRatio:this._iconMoveNormalRatio);for(var t=this._calcSquareCorners(),i=0,o=t.length;o>i;i++){var r=t[i];this._cropCanvas.drawIconResizeCircle(r,this._resizeCtrlBaseRadius,this._resizeCtrlIsHover===i?this._resizeCtrlHoverRatio:this._resizeCtrlNormalRatio)}},t.prototype.processMouseMove=function(e,t){var i="default",o=!1;if(this._resizeCtrlIsHover=-1,this._areaIsHover=!1,this._areaIsDragging)this._x=e-this._posDragStartX,this._y=t-this._posDragStartY,this._areaIsHover=!0,i="move",o=!0,this._events.trigger("area-move");else if(this._resizeCtrlIsDragging>-1){var r,n;switch(this._resizeCtrlIsDragging){case 0:r=-1,n=-1,i="nwse-resize";break;case 1:r=1,n=-1,i="nesw-resize";break;case 2:r=-1,n=1,i="nesw-resize";break;case 3:r=1,n=1,i="nwse-resize"}var s,a=(e-this._posResizeStartX)*r,c=(t-this._posResizeStartY)*n;s=a>c?this._posResizeStartSize+c:this._posResizeStartSize+a;var l=this._size;this._size=Math.max(this._minSize,s);var u=(this._size-l)/2;this._x+=u*r,this._y+=u*n,this._resizeCtrlIsHover=this._resizeCtrlIsDragging,o=!0,this._events.trigger("area-resize")}else{var h=this._isCoordWithinResizeCtrl([e,t]);if(h>-1){switch(h){case 0:i="nwse-resize";break;case 1:i="nesw-resize";break;case 2:i="nesw-resize";break;case 3:i="nwse-resize"}this._areaIsHover=!1,this._resizeCtrlIsHover=h,o=!0}else this._isCoordWithinArea([e,t])&&(i="move",this._areaIsHover=!0,o=!0)}return this._dontDragOutside(),angular.element(this._ctx.canvas).css({cursor:i}),o},t.prototype.processMouseDown=function(e,t){var i=this._isCoordWithinResizeCtrl([e,t]);i>-1?(this._areaIsDragging=!1,this._areaIsHover=!1,this._resizeCtrlIsDragging=i,this._resizeCtrlIsHover=i,this._posResizeStartX=e,this._posResizeStartY=t,this._posResizeStartSize=this._size,this._events.trigger("area-resize-start")):this._isCoordWithinArea([e,t])&&(this._areaIsDragging=!0,this._areaIsHover=!0,this._resizeCtrlIsDragging=-1,this._resizeCtrlIsHover=-1,this._posDragStartX=e-this._x,this._posDragStartY=t-this._y,this._events.trigger("area-move-start"))},t.prototype.processMouseUp=function(){this._areaIsDragging&&(this._areaIsDragging=!1,this._events.trigger("area-move-end")),this._resizeCtrlIsDragging>-1&&(this._resizeCtrlIsDragging=-1,this._events.trigger("area-resize-end")),this._areaIsHover=!1,this._resizeCtrlIsHover=-1,this._posDragStartX=0,this._posDragStartY=0},t}]),e.factory("cropArea",["cropCanvas",function(e){var t=function(t,i){this._ctx=t,this._events=i,this._minSize=80,this._cropCanvas=new e(t),this._image=new Image,this._x=0,this._y=0,this._size=200};return t.prototype.getImage=function(){return this._image},t.prototype.setImage=function(e){this._image=e},t.prototype.getX=function(){return this._x},t.prototype.setX=function(e){this._x=e,this._dontDragOutside()},t.prototype.getY=function(){return this._y},t.prototype.setY=function(e){this._y=e,this._dontDragOutside()},t.prototype.getSize=function(){return this._size},t.prototype.setSize=function(e){this._size=Math.max(this._minSize,e),this._dontDragOutside()},t.prototype.getMinSize=function(){return this._minSize},t.prototype.setMinSize=function(e){this._minSize=e,this._size=Math.max(this._minSize,this._size),this._dontDragOutside()},t.prototype._dontDragOutside=function(){var e=this._ctx.canvas.height,t=this._ctx.canvas.width;this._size>t&&(this._size=t),this._size>e&&(this._size=e),this._x<this._size/2&&(this._x=this._size/2),this._x>t-this._size/2&&(this._x=t-this._size/2),this._y<this._size/2&&(this._y=this._size/2),this._y>e-this._size/2&&(this._y=e-this._size/2)},t.prototype._drawArea=function(){},t.prototype.draw=function(){this._cropCanvas.drawCropArea(this._image,[this._x,this._y],this._size,this._drawArea)},t.prototype.processMouseMove=function(){},t.prototype.processMouseDown=function(){},t.prototype.processMouseUp=function(){},t}]),e.factory("cropCanvas",[function(){var e=[[-.5,-2],[-3,-4.5],[-.5,-7],[-7,-7],[-7,-.5],[-4.5,-3],[-2,-.5]],t=[[.5,-2],[3,-4.5],[.5,-7],[7,-7],[7,-.5],[4.5,-3],[2,-.5]],i=[[-.5,2],[-3,4.5],[-.5,7],[-7,7],[-7,.5],[-4.5,3],[-2,.5]],o=[[.5,2],[3,4.5],[.5,7],[7,7],[7,.5],[4.5,3],[2,.5]],r=[[-1.5,-2.5],[-1.5,-6],[-5,-6],[0,-11],[5,-6],[1.5,-6],[1.5,-2.5]],n=[[-2.5,-1.5],[-6,-1.5],[-6,-5],[-11,0],[-6,5],[-6,1.5],[-2.5,1.5]],s=[[-1.5,2.5],[-1.5,6],[-5,6],[0,11],[5,6],[1.5,6],[1.5,2.5]],a=[[2.5,-1.5],[6,-1.5],[6,-5],[11,0],[6,5],[6,1.5],[2.5,1.5]],c={areaOutline:"#fff",resizeBoxStroke:"#fff",resizeBoxFill:"#444",resizeBoxArrowFill:"#fff",resizeCircleStroke:"#fff",resizeCircleFill:"#444",moveIconFill:"#fff"};return function(l){var u=function(e,t,i){return[i*e[0]+t[0],i*e[1]+t[1]]},h=function(e,t,i,o){l.save(),l.fillStyle=t,l.beginPath();var r,n=u(e[0],i,o);l.moveTo(n[0],n[1]);for(var s in e)s>0&&(r=u(e[s],i,o),l.lineTo(r[0],r[1]));l.lineTo(n[0],n[1]),l.fill(),l.closePath(),l.restore()};this.drawIconMove=function(e,t){h(r,c.moveIconFill,e,t),h(n,c.moveIconFill,e,t),h(s,c.moveIconFill,e,t),h(a,c.moveIconFill,e,t)},this.drawIconResizeCircle=function(e,t,i){var o=t*i;l.save(),l.strokeStyle=c.resizeCircleStroke,l.lineWidth=2,l.fillStyle=c.resizeCircleFill,l.beginPath(),l.arc(e[0],e[1],o,0,2*Math.PI),l.fill(),l.stroke(),l.closePath(),l.restore()},this.drawIconResizeBoxBase=function(e,t,i){var o=t*i;l.save(),l.strokeStyle=c.resizeBoxStroke,l.lineWidth=2,l.fillStyle=c.resizeBoxFill,l.fillRect(e[0]-o/2,e[1]-o/2,o,o),l.strokeRect(e[0]-o/2,e[1]-o/2,o,o),l.restore()},this.drawIconResizeBoxNESW=function(e,o,r){this.drawIconResizeBoxBase(e,o,r),h(t,c.resizeBoxArrowFill,e,r),h(i,c.resizeBoxArrowFill,e,r)},this.drawIconResizeBoxNWSE=function(t,i,r){this.drawIconResizeBoxBase(t,i,r),h(e,c.resizeBoxArrowFill,t,r),h(o,c.resizeBoxArrowFill,t,r)},this.drawCropArea=function(e,t,i,o){var r=e.width/l.canvas.width,n=e.height/l.canvas.height,s=t[0]-i/2,a=t[1]-i/2;l.save(),l.strokeStyle=c.areaOutline,l.lineWidth=2,l.beginPath(),o(l,t,i),l.stroke(),l.clip(),i>0&&l.drawImage(e,s*r,a*n,i*r,i*n,s,a,i,i),l.beginPath(),o(l,t,i),l.stroke(),l.clip(),l.restore()}}}]),e.service("cropEXIF",[function(){function e(e){return!!e.exifdata}function t(e,t){t=t||e.match(/^data\:([^\;]+)\;base64,/im)[1]||"",e=e.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var i=atob(e),o=i.length,r=new ArrayBuffer(o),n=new Uint8Array(r),s=0;o>s;s++)n[s]=i.charCodeAt(s);return r}function i(e,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="blob",i.onload=function(e){(200==this.status||0===this.status)&&t(this.response)},i.send()}function o(e,o){function s(t){var i=r(t),s=n(t);e.exifdata=i||{},e.iptcdata=s||{},o&&o.call(e)}if(e.src)if(/^data\:/i.test(e.src)){var a=t(e.src);s(a)}else if(/^blob\:/i.test(e.src)){var c=new FileReader;c.onload=function(e){s(e.target.result)},i(e.src,function(e){c.readAsArrayBuffer(e)})}else{var l=new XMLHttpRequest;l.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";s(l.response),l=null},l.open("GET",e.src,!0),l.responseType="arraybuffer",l.send(null)}else if(window.FileReader&&(e instanceof window.Blob||e instanceof window.File)){var c=new FileReader;c.onload=function(e){h&&console.log("Got file of length "+e.target.result.byteLength),s(e.target.result)},c.readAsArrayBuffer(e)}}function r(e){var t=new DataView(e);if(h&&console.log("Got file of length "+e.byteLength),255!=t.getUint8(0)||216!=t.getUint8(1))return h&&console.log("Not a valid JPEG"),!1;for(var i,o=2,r=e.byteLength;r>o;){if(255!=t.getUint8(o))return h&&console.log("Not a valid marker at offset "+o+", found: "+t.getUint8(o)),!1;if(i=t.getUint8(o+1),h&&console.log(i),225==i)return h&&console.log("Found 0xFFE1 marker"),u(t,o+4,t.getUint16(o+2)-2);o+=2+t.getUint16(o+2)}}function n(e){var t=new DataView(e);if(h&&console.log("Got file of length "+e.byteLength),255!=t.getUint8(0)||216!=t.getUint8(1))return h&&console.log("Not a valid JPEG"),!1;for(var i=2,o=e.byteLength,r=function(e,t){return 56===e.getUint8(t)&&66===e.getUint8(t+1)&&73===e.getUint8(t+2)&&77===e.getUint8(t+3)&&4===e.getUint8(t+4)&&4===e.getUint8(t+5)};o>i;){if(r(t,i)){var n=t.getUint8(i+7);n%2!==0&&(n+=1),0===n&&(n=4);var a=i+8+n,c=t.getUint16(i+6+n);return s(e,a,c)}i++}}function s(e,t,i){for(var o,r,n,s,a,c=new DataView(e),u={},h=t;t+i>h;)28===c.getUint8(h)&&2===c.getUint8(h+1)&&(s=c.getUint8(h+2),s in f&&(n=c.getInt16(h+3),a=n+5,r=f[s],o=l(c,h+5,n),u.hasOwnProperty(r)?u[r]instanceof Array?u[r].push(o):u[r]=[u[r],o]:u[r]=o)),h++;return u}function a(e,t,i,o,r){var n,s,a,l=e.getUint16(i,!r),u={};for(a=0;l>a;a++)n=i+12*a+2,s=o[e.getUint16(n,!r)],!s&&h&&console.log("Unknown tag: "+e.getUint16(n,!r)),u[s]=c(e,n,t,i,r);return u}function c(e,t,i,o,r){var n,s,a,c,u,h,g=e.getUint16(t+2,!r),d=e.getUint32(t+4,!r),p=e.getUint32(t+8,!r)+i;switch(g){case 1:case 7:if(1==d)return e.getUint8(t+8,!r);for(n=d>4?p:t+8,s=[],c=0;d>c;c++)s[c]=e.getUint8(n+c);return s;case 2:return n=d>4?p:t+8,l(e,n,d-1);case 3:if(1==d)return e.getUint16(t+8,!r);for(n=d>2?p:t+8,s=[],c=0;d>c;c++)s[c]=e.getUint16(n+2*c,!r);return s;case 4:if(1==d)return e.getUint32(t+8,!r);for(s=[],c=0;d>c;c++)s[c]=e.getUint32(p+4*c,!r);return s;case 5:if(1==d)return u=e.getUint32(p,!r),h=e.getUint32(p+4,!r),a=new Number(u/h),a.numerator=u,a.denominator=h,a;for(s=[],c=0;d>c;c++)u=e.getUint32(p+8*c,!r),h=e.getUint32(p+4+8*c,!r),s[c]=new Number(u/h),s[c].numerator=u,s[c].denominator=h;return s;case 9:if(1==d)return e.getInt32(t+8,!r);for(s=[],c=0;d>c;c++)s[c]=e.getInt32(p+4*c,!r);return s;case 10:if(1==d)return e.getInt32(p,!r)/e.getInt32(p+4,!r);for(s=[],c=0;d>c;c++)s[c]=e.getInt32(p+8*c,!r)/e.getInt32(p+4+8*c,!r);return s}}function l(e,t,i){for(var o="",r=t;t+i>r;r++)o+=String.fromCharCode(e.getUint8(r));return o}function u(e,t){if("Exif"!=l(e,t,4))return h&&console.log("Not valid EXIF data! "+l(e,t,4)),!1;var i,o,r,n,s,c=t+6;if(18761==e.getUint16(c))i=!1;else{if(19789!=e.getUint16(c))return h&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;i=!0}if(42!=e.getUint16(c+2,!i))return h&&console.log("Not valid TIFF data! (no 0x002A)"),!1;var u=e.getUint32(c+4,!i);if(8>u)return h&&console.log("Not valid TIFF data! (First offset less than 8)",e.getUint32(c+4,!i)),!1;if(o=a(e,c,c+u,d,i),o.ExifIFDPointer){n=a(e,c,c+o.ExifIFDPointer,g,i);for(r in n){switch(r){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":n[r]=m[r][n[r]];break;case"ExifVersion":case"FlashpixVersion":n[r]=String.fromCharCode(n[r][0],n[r][1],n[r][2],n[r][3]);break;case"ComponentsConfiguration":n[r]=m.Components[n[r][0]]+m.Components[n[r][1]]+m.Components[n[r][2]]+m.Components[n[r][3]]}o[r]=n[r]}}if(o.GPSInfoIFDPointer){s=a(e,c,c+o.GPSInfoIFDPointer,p,i);for(r in s){switch(r){case"GPSVersionID":s[r]=s[r][0]+"."+s[r][1]+"."+s[r][2]+"."+s[r][3]}o[r]=s[r]}}return o}var h=!1,g=this.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},d=this.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},p=this.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},m=this.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",
17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}},f={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};this.getData=function(t,i){return(t instanceof Image||t instanceof HTMLImageElement)&&!t.complete?!1:(e(t)?i&&i.call(t):o(t,i),!0)},this.getTag=function(t,i){return e(t)?t.exifdata[i]:void 0},this.getAllTags=function(t){if(!e(t))return{};var i,o=t.exifdata,r={};for(i in o)o.hasOwnProperty(i)&&(r[i]=o[i]);return r},this.pretty=function(t){if(!e(t))return"";var i,o=t.exifdata,r="";for(i in o)o.hasOwnProperty(i)&&(r+="object"==typeof o[i]?o[i]instanceof Number?i+" : "+o[i]+" ["+o[i].numerator+"/"+o[i].denominator+"]\r\n":i+" : ["+o[i].length+" values]\r\n":i+" : "+o[i]+"\r\n");return r},this.readFromBinaryFile=function(e){return r(e)}}]),e.factory("cropHost",["$document","cropAreaCircle","cropAreaSquare","cropEXIF",function(e,t,i,o){var r=function(e){var t=e.getBoundingClientRect(),i=document.body,o=document.documentElement,r=window.pageYOffset||o.scrollTop||i.scrollTop,n=window.pageXOffset||o.scrollLeft||i.scrollLeft,s=o.clientTop||i.clientTop||0,a=o.clientLeft||i.clientLeft||0,c=t.top+r-s,l=t.left+n-a;return{top:Math.round(c),left:Math.round(l)}};return function(n,s,a){function c(){l.clearRect(0,0,l.canvas.width,l.canvas.height),null!==u&&(l.drawImage(u,0,0,l.canvas.width,l.canvas.height),l.save(),l.fillStyle="rgba(0, 0, 0, 0.65)",l.fillRect(0,0,l.canvas.width,l.canvas.height),l.restore(),h.draw())}var l=null,u=null,h=null,g=[300,300],d=[800,800],p=200,m="image/png",f=null,v=function(){if(null!==u){h.setImage(u);var e=[u.width,u.height],t=u.width/u.height,i=e;i[0]>d[0]?(i[0]=d[0],i[1]=i[0]/t):i[0]<g[0]&&(i[0]=g[0],i[1]=i[0]/t),i[1]>d[1]?(i[1]=d[1],i[0]=i[1]*t):i[1]<g[1]&&(i[1]=g[1],i[0]=i[1]*t),n.prop("width",i[0]).prop("height",i[1]).css({"margin-left":-i[0]/2+"px","margin-top":-i[1]/2+"px"}),h.setX(l.canvas.width/2),h.setY(l.canvas.height/2),h.setSize(Math.min(200,l.canvas.width/2,l.canvas.height/2))}else n.prop("width",0).prop("height",0).css({"margin-top":0});c()},_=function(e){return angular.isDefined(e.changedTouches)?e.changedTouches:e.originalEvent.changedTouches},S=function(e){if(null!==u){var t,i,o=r(l.canvas);"touchmove"===e.type?(t=_(e)[0].pageX,i=_(e)[0].pageY):(t=e.pageX,i=e.pageY),h.processMouseMove(t-o.left,i-o.top),c()}},I=function(e){if(e.preventDefault(),e.stopPropagation(),null!==u){var t,i,o=r(l.canvas);"touchstart"===e.type?(t=_(e)[0].pageX,i=_(e)[0].pageY):(t=e.pageX,i=e.pageY),h.processMouseDown(t-o.left,i-o.top),c()}},y=function(e){if(null!==u){var t,i,o=r(l.canvas);"touchend"===e.type?(t=_(e)[0].pageX,i=_(e)[0].pageY):(t=e.pageX,i=e.pageY),h.processMouseUp(t-o.left,i-o.top),c()}};this.getResultImageDataURI=function(){var e,t;return t=angular.element("<canvas></canvas>")[0],e=t.getContext("2d"),t.width=p,t.height=p,null!==u&&e.drawImage(u,(h.getX()-h.getSize()/2)*(u.width/l.canvas.width),(h.getY()-h.getSize()/2)*(u.height/l.canvas.height),h.getSize()*(u.width/l.canvas.width),h.getSize()*(u.height/l.canvas.height),0,0,p,p),null!==f?t.toDataURL(m,f):t.toDataURL(m)},this.setNewImageSource=function(e){if(u=null,v(),a.trigger("image-updated"),e){var t=new Image;"http"===e.substring(0,4).toLowerCase()&&(t.crossOrigin="anonymous"),t.onload=function(){a.trigger("load-done"),o.getData(t,function(){var e=o.getTag(t,"Orientation");if([3,6,8].indexOf(e)>-1){var i=document.createElement("canvas"),r=i.getContext("2d"),n=t.width,s=t.height,c=0,l=0,h=0;switch(e){case 3:c=-t.width,l=-t.height,h=180;break;case 6:n=t.height,s=t.width,l=-t.height,h=90;break;case 8:n=t.height,s=t.width,c=-t.width,h=270}i.width=n,i.height=s,r.rotate(h*Math.PI/180),r.drawImage(t,c,l),u=new Image,u.src=i.toDataURL("image/png")}else u=t;v(),a.trigger("image-updated")})},t.onerror=function(){a.trigger("load-error")},a.trigger("load-start"),t.src=e}},this.setMaxDimensions=function(e,t){if(d=[e,t],null!==u){var i=l.canvas.width,o=l.canvas.height,r=[u.width,u.height],s=u.width/u.height,a=r;a[0]>d[0]?(a[0]=d[0],a[1]=a[0]/s):a[0]<g[0]&&(a[0]=g[0],a[1]=a[0]/s),a[1]>d[1]?(a[1]=d[1],a[0]=a[1]*s):a[1]<g[1]&&(a[1]=g[1],a[0]=a[1]*s),n.prop("width",a[0]).prop("height",a[1]).css({"margin-left":-a[0]/2+"px","margin-top":-a[1]/2+"px"});var p=l.canvas.width/i,m=l.canvas.height/o,f=Math.min(p,m);h.setX(h.getX()*p),h.setY(h.getY()*m),h.setSize(h.getSize()*f)}else n.prop("width",0).prop("height",0).css({"margin-top":0});c()},this.setAreaMinSize=function(e){e=parseInt(e,10),isNaN(e)||(h.setMinSize(e),c())},this.setResultImageSize=function(e){e=parseInt(e,10),isNaN(e)||(p=e)},this.setResultImageFormat=function(e){m=e},this.setResultImageQuality=function(e){e=parseFloat(e),!isNaN(e)&&e>=0&&1>=e&&(f=e)},this.setAreaType=function(e){var o=h.getSize(),r=h.getMinSize(),n=h.getX(),s=h.getY(),g=t;"square"===e&&(g=i),h=new g(l,a),h.setMinSize(r),h.setSize(o),h.setX(n),h.setY(s),null!==u&&h.setImage(u),c()},l=n[0].getContext("2d"),h=new t(l,a),e.on("mousemove",S),n.on("mousedown",I),e.on("mouseup",y),e.on("touchmove",S),n.on("touchstart",I),e.on("touchend",y),this.destroy=function(){e.off("mousemove",S),n.off("mousedown",I),e.off("mouseup",S),e.off("touchmove",S),n.off("touchstart",I),e.off("touchend",S),n.remove()}}}]),e.factory("cropPubSub",[function(){return function(){var e={};this.on=function(t,i){return t.split(" ").forEach(function(t){e[t]||(e[t]=[]),e[t].push(i)}),this},this.trigger=function(t,i){return angular.forEach(e[t],function(e){e.call(null,i)}),this}}}]),e.directive("imgCrop",["$timeout","cropHost","cropPubSub",function(e,t,i){return{restrict:"E",scope:{image:"=",resultImage:"=",changeOnFly:"=",areaType:"@",areaMinSize:"=",resultImageSize:"=",resultImageFormat:"@",resultImageQuality:"=",onChange:"&",onLoadBegin:"&",onLoadDone:"&",onLoadError:"&"},template:"<canvas></canvas>",controller:["$scope",function(e){e.events=new i}],link:function(i,o){var r,n=i.events,s=new t(o.find("canvas"),{},n),a=function(e){var t=s.getResultImageDataURI();r!==t&&(r=t,angular.isDefined(e.resultImage)&&(e.resultImage=t),e.onChange({$dataURI:e.resultImage}))},c=function(t){return function(){e(function(){i.$apply(function(e){t(e)})})}};n.on("load-start",c(function(e){e.onLoadBegin({})})).on("load-done",c(function(e){e.onLoadDone({})})).on("load-error",c(function(e){e.onLoadError({})})).on("area-move area-resize",c(function(e){e.changeOnFly&&a(e)})).on("area-move-end area-resize-end image-updated",c(function(e){a(e)})),i.$watch("image",function(){s.setNewImageSource(i.image)}),i.$watch("areaType",function(){s.setAreaType(i.areaType),a(i)}),i.$watch("areaMinSize",function(){s.setAreaMinSize(i.areaMinSize),a(i)}),i.$watch("resultImageSize",function(){s.setResultImageSize(i.resultImageSize),a(i)}),i.$watch("resultImageFormat",function(){s.setResultImageFormat(i.resultImageFormat),a(i)}),i.$watch("resultImageQuality",function(){s.setResultImageQuality(i.resultImageQuality),a(i)}),i.$watch(function(){return[o[0].clientWidth,o[0].clientHeight]},function(e){s.setMaxDimensions(e[0],e[1]),a(i)},!0),i.$on("$destroy",function(){s.destroy()})}}}])}(),function(){"use strict";function e(){return{restrict:"E",controller:"PlgEditFabSpeedDialController",templateUrl:"myComponentSample.html",replace:!0,link:function(e){e.tagline="it Works!"}}}angular.module("plingUi").directive("plgEditFabSpeedDial",e)}(),function(){"use strict";angular.module("plingUi").directive("plgSetFocus",["$parse","$timeout",function(e,t){return{restrict:"A",replace:!0,link:function(i,o,r){var n=e(r.plgSetFocus);i.$watch(n,function(e){e===!0&&t(function(){o[0].focus()})}),o.bind("blur",function(){i.$apply(n.assign(i,!1))})}}}])}(),angular.module("plingUi.templates",[]).run(["$templateCache",function(e){e.put("myComponentSample.html","<div class=myComponentSample>My Component Sample: <span ng-bind=tagline></span></div>"),e.put("plgEditFabSpeedDial.template.html","")}]);
//# sourceMappingURL=pling-ui.min.js.map
